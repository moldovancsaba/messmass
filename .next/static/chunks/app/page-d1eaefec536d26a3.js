(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{376:(e,t,s)=>{"use strict";function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);s.push.apply(s,a)}return s})(Object(t)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}),e}s.d(t,{_:()=>a})},1057:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5594),n=s(376),r=s(5155),c=s(2115),o=s(5717),l=s.n(o);let i={remoteImages:0,hostessImages:0,selfies:0,indoor:0,outdoor:0,stadium:0,female:0,male:0,genAlpha:0,genYZ:0,genX:0,boomer:0,merched:0,jersey:0,scarf:0,flags:0,baseballCap:0,other:0,approvedImages:0,rejectedImages:0,eventAttendees:0,eventTicketPurchases:0,visitQrCode:0,visitShortUrl:0,visitWeb:0,visitFacebook:0,visitInstagram:0,visitYoutube:0,visitTiktok:0,visitX:0,visitTrustpilot:0,eventResultHome:0,eventResultVisitor:0,eventValuePropositionVisited:0,eventValuePropositionPurchases:0};function d(){let[e,t]=(0,c.useState)(null),[s,o]=(0,c.useState)(""),[d,u]=(0,c.useState)(new Date().toISOString().split("T")[0]),[p,_]=(0,c.useState)(i),[j,v]=(0,c.useState)([]),[m,g]=(0,c.useState)(!1),[h,b]=(0,c.useState)(!1),[x,y]=(0,c.useState)("idle"),[N,f]=(0,c.useState)(!1),[S,C]=(0,c.useState)(0),[k,T]=(0,c.useState)("disconnected"),[P,w]=(0,c.useState)(null),I=(0,c.useRef)(null),D=(0,c.useRef)(null),K=(0,c.useRef)(null),V=(0,c.useCallback)(()=>{var e;if((null==(e=I.current)?void 0:e.readyState)!==WebSocket.OPEN){T("connecting");try{I.current=new WebSocket("wss://messmass-production.up.railway.app"),I.current.onopen=()=>{console.log("\uD83D\uDD17 WebSocket connected"),T("connected"),f(!0),D.current&&(clearTimeout(D.current),D.current=null)},I.current.onmessage=e=>{try{let t=JSON.parse(e.data);O(t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},I.current.onclose=()=>{console.log("\uD83D\uDD0C WebSocket disconnected"),T("disconnected"),f(!1),C(0),K.current=null,D.current=setTimeout(()=>{V()},3e3)},I.current.onerror=e=>{console.error("❌ WebSocket error:",e),T("error")}}catch(e){console.error("Failed to create WebSocket connection:",e),T("error")}}},[]),O=(0,c.useCallback)(e=>{switch(console.log("\uD83D\uDCE8 Received:",e.type),e.type){case"connection_established":K.current=e.connectionId,console.log("✅ Connection ID:",e.connectionId);break;case"project_joined":C(e.activeUsers);break;case"user_joined":case"user_left":C(e.activeUsers),w("User ".concat(e.type.split("_")[1]," at ").concat(new Date(e.timestamp).toLocaleTimeString()));break;case"stat_updated":e.updatedBy!==K.current&&(_(t=>(0,n._)((0,a._)({},t),{[e.statKey]:e.newValue})),w("".concat(e.statKey," updated by another user")));break;case"project_updated":e.updatedBy!==K.current&&(o(e.eventName),u(e.eventDate),_(e.stats),w("Project updated by another user at ".concat(new Date(e.timestamp).toLocaleTimeString())));break;case"stats_reset":e.resetBy!==K.current&&(_(e.stats),w("Stats reset by another user at ".concat(new Date(e.timestamp).toLocaleTimeString())));break;case"error":console.error("WebSocket error:",e.message);break;default:console.log("Unknown message type:",e.type)}},[]),E=(0,c.useCallback)(e=>{var t;return(null==(t=I.current)?void 0:t.readyState)===WebSocket.OPEN&&(I.current.send(JSON.stringify(e)),!0)},[]),B=(0,c.useCallback)(e=>{E({type:"join_project",projectId:e})||console.warn("Failed to join project room - WebSocket not connected")},[E]),R=(0,c.useCallback)(()=>{E({type:"leave_project"})},[E]);(0,c.useEffect)(()=>(V(),()=>{D.current&&clearTimeout(D.current),I.current&&I.current.close()}),[V]),(0,c.useEffect)(()=>{G()},[]),(0,c.useEffect)(()=>{if(e&&s.trim()){let e=setTimeout(()=>{U()},1e3);return()=>clearTimeout(e)}},[p,s,d,e]),(0,c.useEffect)(()=>{e&&N?B(e):!e&&N&&R()},[e,N,B,R]);let G=async()=>{try{let e=await fetch("/api/projects"),t=await e.json();t.projects&&v(t.projects)}catch(e){console.error("Failed to load projects:",e)}},F=async()=>{if(!s.trim())return void alert("Please enter an event name before saving.");y("saving");try{let e=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventName:s,eventDate:d,stats:p})}),a=await e.json();a.success?(t(a.projectId),y("saved"),setTimeout(()=>y("idle"),2e3),G(),N&&B(a.projectId)):(y("error"),alert("Failed to save project. Please try again."))}catch(e){console.error("Failed to save project:",e),y("error"),alert("Failed to save project. Please check your connection.")}},U=async()=>{if(e&&s.trim()){y("saving");try{(await fetch("/api/projects",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,a._)({projectId:e},{eventName:s,eventDate:d,stats:p}))})).ok?(y("saved"),setTimeout(()=>y("idle"),2e3),E({type:"project_update",eventName:s,eventDate:d,stats:p})):y("error")}catch(e){console.error("Failed to update project:",e),y("error")}}},L=async s=>{e&&N&&R();try{let e=await fetch("/api/projects/".concat(s._id));if(e.ok){let s=await e.json();if(s.project){t(s.project._id),o(s.project.eventName),u(s.project.eventDate),_(s.project.stats),g(!1);return}}}catch(e){console.error("Failed to fetch fresh project data:",e)}t(s._id),o(s.eventName),u(s.eventDate),_(s.stats),g(!1)},W=async t=>{if(confirm("Are you sure you want to delete this project?"))try{(await fetch("/api/projects?projectId=".concat(t),{method:"DELETE"})).ok&&(G(),e===t&&A())}catch(e){console.error("Failed to delete project:",e)}},A=()=>{e&&N&&R(),t(null),o(""),u(new Date().toISOString().split("T")[0]),_(i),g(!1),C(0)},M=p.remoteImages+p.hostessImages+p.selfies,X=p.indoor+p.outdoor+p.stadium,Y=p.female+p.male,H=p.genAlpha+p.genYZ,Z=p.genX+p.boomer,J=H+Z,q=p.merched+p.jersey+p.scarf+p.flags+p.baseballCap+p.other,z=t=>{let{label:s,value:c,statKey:o,isCalculated:i=!1,isWarning:d=!1}=t;return(0,r.jsxs)("div",{className:l().statCardContainer,children:[(0,r.jsxs)("div",{className:"".concat(l().statCard," ").concat(i?l().calculatedCard:""," ").concat(d?l().warningCard:""),onClick:o?()=>(t=>{let s=p[t]+1;_(e=>(0,n._)((0,a._)({},e),{[t]:s})),e&&N&&E({type:"stat_increment",statKey:t,newValue:s})})(o):void 0,style:{cursor:i?"default":"pointer"},children:[(0,r.jsx)("div",{className:l().statLabel,children:s}),(0,r.jsx)("div",{className:l().statValue,children:c})]}),o&&!i&&(0,r.jsx)("button",{className:l().decrementButton,onClick:t=>{t.stopPropagation();if(p[o]>0){let t=p[o]-1;_(e=>(0,n._)((0,a._)({},e),{[o]:t})),e&&N&&E({type:"stat_increment",statKey:o,newValue:t})}},disabled:0===c,children:"-1"})]})},Q=t=>{let{label:s,value:o,statKey:i}=t,[d,u]=(0,c.useState)(o);return(0,c.useEffect)(()=>{u(o)},[o]),(0,r.jsx)("div",{className:l().statCardContainer,children:(0,r.jsxs)("div",{className:l().statCard,children:[(0,r.jsx)("div",{className:l().statLabel,children:s}),(0,r.jsx)("input",{type:"number",value:d,onChange:e=>{u(Math.max(0,parseInt(e.target.value)||0))},onBlur:()=>{let t=Math.max(0,parseInt(d.toString())||0);t!==o&&(_(e=>(0,n._)((0,a._)({},e),{[i]:t})),e&&N&&E({type:"stat_increment",statKey:i,newValue:t}))},className:l().successManagerInput,min:"0"})]})})};return(0,r.jsx)("main",{className:l().main,children:(0,r.jsxs)("div",{className:l().container,children:[(0,r.jsxs)("div",{className:l().header,children:[e&&s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{className:l().title,children:s}),(0,r.jsx)("p",{className:l().subtitle,children:new Date(d).toLocaleDateString()})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{className:l().title,children:"MessMass"}),(0,r.jsx)("p",{className:l().subtitle,children:"Event Statistics Dashboard"})]}),(0,r.jsx)(()=>(0,r.jsxs)("div",{className:l().connectionStatus,children:[(0,r.jsxs)("div",{className:"".concat(l().statusIndicator," ").concat(l()[k]),children:["connected"===k&&"\uD83D\uDFE2","connecting"===k&&"\uD83D\uDFE1","disconnected"===k&&"\uD83D\uDD34","error"===k&&"❌"]}),(0,r.jsxs)("span",{className:l().statusText,children:["connected"===k&&"Connected (".concat(S," user").concat(1!==S?"s":"",")"),"connecting"===k&&"Connecting...","disconnected"===k&&"Offline","error"===k&&"Connection Error"]})]}),{}),P&&(0,r.jsxs)("div",{className:l().lastUpdate,children:["\uD83D\uDCE1 ",P]}),(0,r.jsxs)("div",{className:l().projectControls,children:[(0,r.jsxs)("button",{className:l().projectButton,onClick:()=>g(!m),children:["\uD83D\uDCC1 ",m?"Hide":"Show"," Projects (",j.length,")"]}),(0,r.jsx)("button",{className:l().newProjectButton,onClick:A,children:"➕ New Project"}),"saving"===x&&(0,r.jsx)("span",{className:l().saveStatus,children:"\uD83D\uDCBE Auto-saving..."}),"saved"===x&&(0,r.jsx)("span",{className:l().saveStatus,children:"✅ Auto-saved"}),"error"===x&&(0,r.jsx)("span",{className:l().saveStatus,children:"❌ Save Error"})]})]}),m&&(0,r.jsxs)("div",{className:l().projectsList,children:[(0,r.jsx)("h3",{children:"Your Projects"}),0===j.length?(0,r.jsx)("p",{children:"No projects saved yet. Create your first project by adding an event name and date above."}):(0,r.jsx)("div",{className:l().projectsGrid,children:j.map(t=>(0,r.jsxs)("div",{className:"".concat(l().projectCard," ").concat(e===t._id?l().activeProject:""),children:[(0,r.jsxs)("div",{className:l().projectInfo,children:[(0,r.jsx)("h4",{children:t.eventName}),(0,r.jsx)("p",{children:new Date(t.eventDate).toLocaleDateString()}),(0,r.jsxs)("small",{children:["Updated: ",new Date(t.updatedAt).toLocaleDateString()]})]}),(0,r.jsxs)("div",{className:l().projectActions,children:[(0,r.jsx)("button",{onClick:()=>L(t),className:l().loadButton,children:"\uD83D\uDCC2 Load"}),(0,r.jsx)("button",{onClick:()=>W(t._id),className:l().deleteButton,children:"\uD83D\uDDD1️"})]})]},t._id))})]}),!e&&(0,r.jsxs)("div",{className:l().eventInfo,children:[(0,r.jsxs)("div",{className:l().inputGroup,children:[(0,r.jsx)("label",{className:l().label,children:"Event Name:"}),(0,r.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),placeholder:"Enter event name...",className:l().input})]}),(0,r.jsxs)("div",{className:l().inputGroup,children:[(0,r.jsx)("label",{className:l().label,children:"Event Date:"}),(0,r.jsx)("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:l().input})]}),(0,r.jsx)("div",{className:l().saveProjectGroup,children:(0,r.jsx)("button",{className:l().saveProjectButton,onClick:F,disabled:!s.trim()||"saving"===x,children:"\uD83D\uDCBE Save Project"})})]}),(0,r.jsxs)("div",{className:l().statsGrid,children:[(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsxs)("h3",{className:l().sectionTitle,children:["Images (",M,")"]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(z,{label:"Remote Images",value:p.remoteImages,statKey:"remoteImages"}),(0,r.jsx)(z,{label:"Hostess Images",value:p.hostessImages,statKey:"hostessImages"}),(0,r.jsx)(z,{label:"Selfies",value:p.selfies,statKey:"selfies"})]})]}),(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsxs)("h3",{className:l().sectionTitle,children:["Fans (",X,")"]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(z,{label:"Indoor",value:p.indoor,statKey:"indoor"}),(0,r.jsx)(z,{label:"Outdoor",value:p.outdoor,statKey:"outdoor"}),(0,r.jsx)(z,{label:"Stadium",value:p.stadium,statKey:"stadium"})]})]}),(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsxs)("h3",{className:"".concat(l().sectionTitle," ").concat(Y!==X?l().warningTitle:""),children:["Gender (",Y,")"]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(z,{label:"Female",value:p.female,statKey:"female"}),(0,r.jsx)(z,{label:"Male",value:p.male,statKey:"male"}),(0,r.jsx)(z,{label:"Total Gender",value:Y,isCalculated:!0,isWarning:Y!==X})]})]}),(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsxs)("h3",{className:"".concat(l().sectionTitle," ").concat(J!==X?l().warningTitle:""),children:["Age (",J,")"]}),(0,r.jsxs)("div",{className:l().ageGrid,children:[(0,r.jsx)(z,{label:"Gen Alpha",value:p.genAlpha,statKey:"genAlpha"}),(0,r.jsx)(z,{label:"Gen Y+Z",value:p.genYZ,statKey:"genYZ"}),(0,r.jsx)(z,{label:"Total Under 40",value:H,isCalculated:!0}),(0,r.jsx)(z,{label:"Gen X",value:p.genX,statKey:"genX"}),(0,r.jsx)(z,{label:"Boomer",value:p.boomer,statKey:"boomer"}),(0,r.jsx)(z,{label:"Total Over 40",value:Z,isCalculated:!0})]})]}),(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsxs)("h3",{className:l().sectionTitle,children:["Merch (",q,")"]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(z,{label:"Merched",value:p.merched,statKey:"merched"}),(0,r.jsx)(z,{label:"Jersey",value:p.jersey,statKey:"jersey"}),(0,r.jsx)(z,{label:"Scarf",value:p.scarf,statKey:"scarf"})]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(z,{label:"Flags",value:p.flags,statKey:"flags"}),(0,r.jsx)(z,{label:"Baseball Cap",value:p.baseballCap,statKey:"baseballCap"}),(0,r.jsx)(z,{label:"Other",value:p.other,statKey:"other"})]})]}),(0,r.jsxs)("div",{className:l().section,children:[(0,r.jsx)("h3",{className:l().sectionTitle,children:"Success Manager"}),(0,r.jsxs)("div",{className:l().subsection,children:[(0,r.jsx)("h4",{className:l().subsectionTitle,children:"Image Management"}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"Approved Images",value:p.approvedImages,statKey:"approvedImages"}),(0,r.jsx)(Q,{label:"Rejected Images",value:p.rejectedImages,statKey:"rejectedImages"})]})]}),(0,r.jsxs)("div",{className:l().subsection,children:[(0,r.jsx)("h4",{className:l().subsectionTitle,children:"Visit Tracking"}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"QR Code Visits",value:p.visitQrCode,statKey:"visitQrCode"}),(0,r.jsx)(Q,{label:"Short URL Visits",value:p.visitShortUrl,statKey:"visitShortUrl"}),(0,r.jsx)(Q,{label:"Web Visits",value:p.visitWeb,statKey:"visitWeb"})]})]}),(0,r.jsxs)("div",{className:l().subsection,children:[(0,r.jsx)("h4",{className:l().subsectionTitle,children:"Social Media Visits"}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"Facebook Visits",value:p.visitFacebook,statKey:"visitFacebook"}),(0,r.jsx)(Q,{label:"Instagram Visits",value:p.visitInstagram,statKey:"visitInstagram"}),(0,r.jsx)(Q,{label:"YouTube Visits",value:p.visitYoutube,statKey:"visitYoutube"})]}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"TikTok Visits",value:p.visitTiktok,statKey:"visitTiktok"}),(0,r.jsx)(Q,{label:"X Visits",value:p.visitX,statKey:"visitX"}),(0,r.jsx)(Q,{label:"Trustpilot Visits",value:p.visitTrustpilot,statKey:"visitTrustpilot"})]})]}),(0,r.jsxs)("div",{className:l().subsection,children:[(0,r.jsx)("h4",{className:l().subsectionTitle,children:"Event Performance"}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"Event Attendees",value:p.eventAttendees,statKey:"eventAttendees"}),(0,r.jsx)(Q,{label:"Ticket Purchases",value:p.eventTicketPurchases,statKey:"eventTicketPurchases"}),(0,r.jsx)(Q,{label:"Event Result Home",value:p.eventResultHome,statKey:"eventResultHome"}),(0,r.jsx)(Q,{label:"Event Result Visitor",value:p.eventResultVisitor,statKey:"eventResultVisitor"})]})]}),(0,r.jsxs)("div",{className:l().subsection,children:[(0,r.jsx)("h4",{className:l().subsectionTitle,children:"Value Proposition"}),(0,r.jsxs)("div",{className:l().statsRow,children:[(0,r.jsx)(Q,{label:"Value Prop Visited",value:p.eventValuePropositionVisited,statKey:"eventValuePropositionVisited"}),(0,r.jsx)(Q,{label:"Value Prop Purchases",value:p.eventValuePropositionPurchases,statKey:"eventValuePropositionPurchases"})]})]})]})]})]})})}},1145:(e,t,s)=>{Promise.resolve().then(s.bind(s,1057))},5594:(e,t,s)=>{"use strict";function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},a=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),a.forEach(function(t){var a;a=s[t],t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a})}return e}s.d(t,{_:()=>a})},5717:e=>{e.exports={main:"page_main__nw1Wk",container:"page_container__jZF7q",fadeInUp:"page_fadeInUp__7IOrd",header:"page_header__oRW75",title:"page_title__po7na",subtitle:"page_subtitle__YBgxm",connectionStatus:"page_connectionStatus__T6fGh",statusIndicator:"page_statusIndicator__q6uCX",pulse:"page_pulse__XPtbN",connected:"page_connected__oJHEE",connecting:"page_connecting__V5pfV",disconnected:"page_disconnected__Jdkhq",error:"page_error__JBrsB",statusText:"page_statusText__6Vir_",lastUpdate:"page_lastUpdate__S84r8",eventInfo:"page_eventInfo__4hyVZ",saveProjectGroup:"page_saveProjectGroup__ECveZ",saveProjectButton:"page_saveProjectButton__mkS2t",projectStatus:"page_projectStatus__evC2X",inputGroup:"page_inputGroup__keP_G",label:"page_label__jI4Tf",input:"page_input__lx_gt",statsGrid:"page_statsGrid__kXg9L",section:"page_section__zQZ2o",sectionTitle:"page_sectionTitle__6ic_4",warningTitle:"page_warningTitle__7if7x",warningPulse:"page_warningPulse__z8iEP",subsection:"page_subsection__RzGW_",subsectionTitle:"page_subsectionTitle__y9U7F",statsRow:"page_statsRow__zReHn",ageGrid:"page_ageGrid__D_byq",ageTotal:"page_ageTotal__erTNN",statCardContainer:"page_statCardContainer__TTrFV",statCard:"page_statCard__WFWBf",decrementButton:"page_decrementButton__7hE27",updating:"page_updating__6hKLd",updatePulse:"page_updatePulse__Nvsh9",calculatedCard:"page_calculatedCard__UI0ZC",warningCard:"page_warningCard__PsNj6",statLabel:"page_statLabel__2jNx3",statValue:"page_statValue__tVgp7",actions:"page_actions___si5r",resetButton:"page_resetButton__uvLeL",exportButton:"page_exportButton__H38q1",googleButton:"page_googleButton__m_IrA",projectControls:"page_projectControls__lmk6i",projectButton:"page_projectButton__Dxm_X",newProjectButton:"page_newProjectButton__N5o1l",saveStatus:"page_saveStatus__XonTM",projectsList:"page_projectsList__0gxMS",projectsGrid:"page_projectsGrid__MicJp",projectCard:"page_projectCard__2LcUe",activeProject:"page_activeProject__EEVkH",projectInfo:"page_projectInfo__xg47N",projectActions:"page_projectActions__XeMTu",loadButton:"page_loadButton__PoukU",deleteButton:"page_deleteButton__nk9u9",realtimeIndicator:"page_realtimeIndicator__3zxxv",inactive:"page_inactive__K9fMU",remoteUpdate:"page_remoteUpdate__GRnkI",collaborativeEditing:"page_collaborativeEditing__FlKce",bounce:"page_bounce__i7ayu",successManagerInput:"page_successManagerInput__K90Um"}}},e=>{e.O(0,[938,441,964,358],()=>e(e.s=1145)),_N_E=e.O()}]);