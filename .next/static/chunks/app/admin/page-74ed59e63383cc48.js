(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{4621:(e,s,a)=>{Promise.resolve().then(a.bind(a,4672))},4672:(e,s,a)=>{"use strict";a.d(s,{default:()=>n});var t=a(5155),i=a(2115);function n(e){let{user:s,permissions:a}=e,[n,d]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[r,m]=(0,i.useState)(!0),[o,h]=(0,i.useState)(null),[j,v]=(0,i.useState)("date"),[x,u]=(0,i.useState)("desc"),[p,N]=(0,i.useState)({totalProjects:0,totalEvents:0,totalUsers:0,activeProjects:0,totalApprovedImages:0,totalEventAttendees:0,totalTicketPurchases:0,totalWebVisits:0});(0,i.useEffect)(()=>{k()},[]),(0,i.useEffect)(()=>{g()},[n,j,x]);let g=()=>{c([...n].sort((e,s)=>{let a,t;return("date"===j?(a=new Date(e.eventDate),t=new Date(s.eventDate)):(a=e.eventName.toLowerCase(),t=s.eventName.toLowerCase()),a<t)?"asc"===x?-1:1:a>t?"asc"===x?1:-1:0}))},b=e=>{j===e?u("asc"===x?"desc":"asc"):(v(e),u("date"===e?"desc":"asc"))},k=async()=>{try{m(!0);let e=await fetch("/api/projects");if(!e.ok)throw Error("Failed to fetch projects");let s=await e.json(),a=(s.projects||s||[]).map(e=>({...e,...e.stats||{},originalStats:e.stats}));d(a);let t=a.reduce((e,s)=>e+(s.indoor||0)+(s.outdoor||0)+(s.stadium||0),0),i=a.reduce((e,s)=>{var a;return e+((null==(a=s.originalStats)?void 0:a.approvedImages)||0)},0),n=a.reduce((e,s)=>{var a;return e+((null==(a=s.originalStats)?void 0:a.eventAttendees)||0)},0),l=a.reduce((e,s)=>{var a;return e+((null==(a=s.originalStats)?void 0:a.eventTicketPurchases)||0)},0),c=a.reduce((e,s)=>{let a=s.originalStats||{};return e+(a.visitWeb||0)+(a.visitQrCode||0)+(a.visitShortUrl||0)},0);N({totalProjects:a.length,totalEvents:a.length,totalUsers:t,activeProjects:a.filter(e=>new Date(e.updatedAt)>new Date(Date.now()-864e5)).length,totalApprovedImages:i,totalEventAttendees:n,totalTicketPurchases:l,totalWebVisits:c})}catch(e){h(e instanceof Error?e.message:"An error occurred"),console.error("Fetch projects error:",e)}finally{m(!1)}},f=async e=>{if(!a.canDelete)return void alert("You do not have permission to delete projects");if(confirm("Are you sure you want to delete this project? This action cannot be undone."))try{if(!(await fetch("/api/projects/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete project");k(),alert("Project deleted successfully")}catch(e){alert("Failed to delete project: "+(e instanceof Error?e.message:"Unknown error"))}};return r?(0,t.jsx)("div",{className:"admin-dashboard",children:(0,t.jsx)("div",{className:"admin-header",children:(0,t.jsx)("div",{className:"admin-title",children:"Loading..."})})}):o?(0,t.jsx)("div",{className:"admin-dashboard",children:(0,t.jsxs)("div",{className:"admin-header",children:[(0,t.jsx)("div",{className:"admin-title",children:"Error"}),(0,t.jsx)("p",{children:o}),(0,t.jsx)("button",{onClick:k,className:"admin-btn-refresh",children:"Retry"})]})}):(0,t.jsxs)("div",{className:"admin-dashboard",children:[(0,t.jsxs)("div",{className:"admin-header",children:[(0,t.jsx)("h1",{className:"admin-title",children:"MessMass Admin"}),(0,t.jsx)("p",{className:"admin-subtitle",children:"Event Statistics Management Dashboard"}),(0,t.jsxs)("div",{className:"admin-user-info",children:[(0,t.jsxs)("div",{className:"admin-user-details",children:[(0,t.jsx)("div",{className:"admin-avatar",children:s.name.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{className:"admin-user-text",children:[(0,t.jsx)("h3",{children:s.name}),(0,t.jsxs)("p",{children:[s.role," • ",s.email]})]})]}),(0,t.jsx)("button",{onClick:()=>window.location.href="/admin/login",className:"admin-logout-btn",children:"Logout"})]})]}),(0,t.jsxs)("div",{className:"admin-stats-grid",children:[(0,t.jsxs)("div",{className:"admin-stat-card",children:[(0,t.jsx)("div",{className:"admin-stat-icon",children:(0,t.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,t.jsx)("div",{className:"admin-stat-label",children:"Total Projects"}),(0,t.jsx)("div",{className:"admin-stat-value",children:p.totalProjects})]}),(0,t.jsxs)("div",{className:"admin-stat-card",children:[(0,t.jsx)("div",{className:"admin-stat-icon",children:(0,t.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,t.jsx)("div",{className:"admin-stat-label",children:"Total Audience"}),(0,t.jsx)("div",{className:"admin-stat-value",children:p.totalUsers.toLocaleString()})]}),(0,t.jsxs)("div",{className:"admin-stat-card",children:[(0,t.jsx)("div",{className:"admin-stat-icon",children:(0,t.jsxs)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),(0,t.jsx)("div",{className:"admin-stat-label",children:"Total Web Visits"}),(0,t.jsx)("div",{className:"admin-stat-value",children:p.totalWebVisits.toLocaleString()})]}),(0,t.jsxs)("div",{className:"admin-stat-card",children:[(0,t.jsx)("div",{className:"admin-stat-icon",children:(0,t.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,t.jsx)("div",{className:"admin-stat-label",children:"Event Attendees"}),(0,t.jsx)("div",{className:"admin-stat-value",children:p.totalEventAttendees.toLocaleString()})]})]}),(0,t.jsxs)("div",{className:"admin-success-section",children:[(0,t.jsx)("h3",{className:"admin-success-title",children:"Success Manager Overview"}),(0,t.jsxs)("div",{className:"admin-success-stats",children:[(0,t.jsxs)("div",{className:"admin-success-stat",children:[(0,t.jsx)("div",{className:"admin-success-stat-value",children:p.totalApprovedImages}),(0,t.jsx)("div",{className:"admin-success-stat-label",children:"Approved Images"})]}),(0,t.jsxs)("div",{className:"admin-success-stat",children:[(0,t.jsx)("div",{className:"admin-success-stat-value",children:p.totalEventAttendees}),(0,t.jsx)("div",{className:"admin-success-stat-label",children:"Event Attendees"})]}),(0,t.jsxs)("div",{className:"admin-success-stat",children:[(0,t.jsx)("div",{className:"admin-success-stat-value",children:p.totalTicketPurchases}),(0,t.jsx)("div",{className:"admin-success-stat-label",children:"Ticket Purchases"})]}),(0,t.jsxs)("div",{className:"admin-success-stat",children:[(0,t.jsx)("div",{className:"admin-success-stat-value",children:p.totalWebVisits}),(0,t.jsx)("div",{className:"admin-success-stat-label",children:"Web Visits"})]})]})]}),(0,t.jsxs)("div",{className:"admin-projects-container",children:[(0,t.jsxs)("div",{className:"admin-projects-header",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"admin-projects-title",children:"Event Projects"}),(0,t.jsx)("p",{className:"admin-projects-subtitle",children:"Manage all event statistics projects and their data"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,t.jsxs)("button",{onClick:()=>b("date"),className:"admin-btn ".concat("date"===j?"admin-btn-export":"admin-btn-refresh"),style:{padding:"0.5rem 1rem",fontSize:"0.75rem"},children:["\uD83D\uDCC5 Date ","date"===j&&("desc"===x?"↓":"↑")]}),(0,t.jsxs)("button",{onClick:()=>b("name"),className:"admin-btn ".concat("name"===j?"admin-btn-export":"admin-btn-refresh"),style:{padding:"0.5rem 1rem",fontSize:"0.75rem"},children:["\uD83D\uDCDD Name ","name"===j&&("desc"===x?"↓":"↑")]})]}),(0,t.jsx)("button",{onClick:k,className:"admin-btn-refresh",children:"\uD83D\uDD04 Refresh"})]})]}),(0,t.jsxs)("table",{className:"admin-table",children:[(0,t.jsx)("thead",{className:"admin-table-header",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Event Name"}),(0,t.jsx)("th",{children:"Event Date"}),(0,t.jsx)("th",{children:"Images"}),(0,t.jsx)("th",{children:"Audience"}),(0,t.jsx)("th",{children:"Demographics"}),(0,t.jsx)("th",{children:"Merchandise"}),(0,t.jsx)("th",{children:"Success Metrics"}),(0,t.jsx)("th",{children:"Updated"}),(0,t.jsx)("th",{children:"Actions"})]})}),(0,t.jsx)("tbody",{children:0===l.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:9,children:(0,t.jsxs)("div",{className:"admin-empty-state",children:[(0,t.jsx)("svg",{className:"admin-empty-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,t.jsx)("div",{className:"admin-empty-title",children:"No projects found"}),(0,t.jsx)("div",{className:"admin-empty-subtitle",children:"Get started by creating your first event project"})]})})}):l.map(e=>{let s=e.originalStats||e.stats||e,i=(s.indoor||0)+(s.outdoor||0)+(s.stadium||0),n=(s.remoteImages||0)+(s.hostessImages||0)+(s.selfies||0),d=(s.merched||0)+(s.jersey||0)+(s.scarf||0)+(s.flags||0)+(s.baseballCap||0)+(s.other||0),l=(s.female||0)+(s.male||0),c=(s.genAlpha||0)+(s.genYZ||0)+(s.genX||0)+(s.boomer||0);return(0,t.jsxs)("tr",{className:"admin-table-row",children:[(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsx)("div",{className:"admin-event-name",children:e.eventName})}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsx)("div",{className:"admin-event-date",children:e.eventDate})}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total images",children:["Total: ",n]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Remote:"}),(0,t.jsx)("span",{children:s.remoteImages||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Hostess:"}),(0,t.jsx)("span",{children:s.hostessImages||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Selfies:"}),(0,t.jsx)("span",{children:s.selfies||0})]})]})]})}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total fans",children:["Total: ",i]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Indoor:"}),(0,t.jsx)("span",{children:s.indoor||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Outdoor:"}),(0,t.jsx)("span",{children:s.outdoor||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Stadium:"}),(0,t.jsx)("span",{children:s.stadium||0})]})]})]})}),(0,t.jsxs)("td",{className:"admin-table-cell",children:[(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total gender",children:["Gender: ",l]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"♀ Female:"}),(0,t.jsx)("span",{children:s.female||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"♂ Male:"}),(0,t.jsx)("span",{children:s.male||0})]})]})]}),(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total age",children:["Age: ",c]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Alpha:"}),(0,t.jsx)("span",{children:s.genAlpha||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Y+Z:"}),(0,t.jsx)("span",{children:s.genYZ||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"X:"}),(0,t.jsx)("span",{children:s.genX||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Boomer:"}),(0,t.jsx)("span",{children:s.boomer||0})]})]})]})]}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total merch",children:["Total: ",d]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Merched:"}),(0,t.jsx)("span",{children:s.merched||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Jersey:"}),(0,t.jsx)("span",{children:s.jersey||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Scarf:"}),(0,t.jsx)("span",{children:s.scarf||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Flags:"}),(0,t.jsx)("span",{children:s.flags||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Cap:"}),(0,t.jsx)("span",{children:s.baseballCap||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Other:"}),(0,t.jsx)("span",{children:s.other||0})]})]})]})}),(0,t.jsx)("td",{className:"admin-table-cell success-data",children:(0,t.jsxs)("div",{className:"admin-stat-group",children:[(0,t.jsxs)("div",{className:"admin-stat-total",children:["Approved: ",s.approvedImages||0]}),(0,t.jsxs)("div",{className:"admin-stat-total",children:["Attendees: ",s.eventAttendees||0]}),(0,t.jsxs)("div",{className:"admin-stat-total",children:["Tickets: ",s.eventTicketPurchases||0]}),(0,t.jsxs)("div",{className:"admin-stat-breakdown",children:[(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"QR Visits:"}),(0,t.jsx)("span",{children:s.visitQrCode||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Web Visits:"}),(0,t.jsx)("span",{children:s.visitWeb||0})]}),(0,t.jsxs)("div",{className:"admin-stat-item",children:[(0,t.jsx)("span",{children:"Social:"}),(0,t.jsx)("span",{children:(s.visitFacebook||0)+(s.visitInstagram||0)})]})]})]})}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsxs)("div",{style:{fontSize:"0.75rem",color:"var(--color-gray-600)"},children:[(0,t.jsx)("div",{children:new Date(e.updatedAt).toLocaleDateString()}),(0,t.jsx)("div",{children:new Date(e.updatedAt).toLocaleTimeString()})]})}),(0,t.jsx)("td",{className:"admin-table-cell",children:(0,t.jsxs)("div",{className:"admin-actions",children:[(0,t.jsx)("button",{onClick:()=>(e=>{let s=e.originalStats||e.stats||e,a=new Blob([[["Field","Value"],["Event Name",e.eventName],["Event Date",e.eventDate],["Created",new Date(e.createdAt).toLocaleString()],["Last Updated",new Date(e.updatedAt).toLocaleString()],["",""],["Images",""],["Remote Images",s.remoteImages||0],["Hostess Images",s.hostessImages||0],["Selfies",s.selfies||0],["",""],["Fans",""],["Indoor",s.indoor||0],["Outdoor",s.outdoor||0],["Stadium",s.stadium||0],["",""],["Gender",""],["Female",s.female||0],["Male",s.male||0],["",""],["Age Groups",""],["Gen Alpha",s.genAlpha||0],["Gen Y+Z",s.genYZ||0],["Gen X",s.genX||0],["Boomer",s.boomer||0],["",""],["Merchandise",""],["Merched",s.merched||0],["Jersey",s.jersey||0],["Scarf",s.scarf||0],["Flags",s.flags||0],["Baseball Cap",s.baseballCap||0],["Other",s.other||0],["",""],["Success Manager",""],["Approved Images",s.approvedImages||0],["Rejected Images",s.rejectedImages||0],["Visit QR Code",s.visitQrCode||0],["Visit Short URL",s.visitShortUrl||0],["Visit QR Searched",s.visitQrSearched||0],["Visit Web",s.visitWeb||0],["Visit Facebook",s.visitFacebook||0],["Visit Instagram",s.visitInstagram||0],["Visit YouTube",s.visitYoutube||0],["Visit TikTok",s.visitTiktok||0],["Visit X",s.visitX||0],["Visit Trustpilot",s.visitTrustpilot||0],["Event Attendees",s.eventAttendees||0],["Event Ticket Purchases",s.eventTicketPurchases||0],["Event Result Home",s.eventResultHome||0],["Event Result Visitor",s.eventResultVisitor||0],["Event Value Proposition Visited",s.eventValuePropositionVisited||0],["Event Value Proposition Purchases",s.eventValuePropositionPurchases||0]].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(a),i=document.createElement("a");i.href=t,i.download="".concat(e.eventName.replace(/[^a-z0-9]/gi,"_"),"_complete_data.csv"),i.click(),window.URL.revokeObjectURL(t)})(e),className:"admin-btn admin-btn-export",children:"\uD83D\uDCCA Export"}),a.canDelete&&(0,t.jsx)("button",{onClick:()=>f(e._id),className:"admin-btn admin-btn-delete",children:"\uD83D\uDDD1️ Delete"})]})})]},e._id)})})]})]})]})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=4621)),_N_E=e.O()}]);