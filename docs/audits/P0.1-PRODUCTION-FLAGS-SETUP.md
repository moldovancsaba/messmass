# P0.1: Enable & Verify Security Flags in Production

**Status:** ⚠️ REQUIRES MANUAL ACTION IN VERCEL  
**Priority:** P0 (CRITICAL - Production Blocker)

## Required Actions

### Step 1: Set Environment Variables in Vercel Production

1. Go to Vercel Dashboard → Project Settings → Environment Variables
2. Add the following variables for **Production** environment:
   - `ENABLE_BCRYPT_AUTH=true`
   - `ENABLE_JWT_SESSIONS=true`
   - `ENABLE_HTML_SANITIZATION=true`

### Step 2: Redeploy Application

After setting environment variables, redeploy the application:
- Vercel will automatically redeploy on next push, OR
- Manually trigger redeploy from Vercel dashboard

### Step 3: Verify Flags Are Enabled

**Option A: Use Verification Script (Recommended)**
```bash
# In production environment (Vercel build logs or runtime)
NODE_ENV=production npm run verify:production-flags
```

**Option B: Check Startup Logs**
- Application startup will fail with clear error message if flags are missing
- If startup succeeds, flags are correctly set

**Option C: Check Vercel Environment Variables**
- Verify variables are set in Vercel dashboard
- Confirm they are set for **Production** environment (not just Preview)

## Verification Checklist

- [ ] All three flags set in Vercel Production environment
- [ ] Application redeployed after setting flags
- [ ] Production startup succeeds (no validation errors)
- [ ] Verification script passes (if runnable in production)
- [ ] No security features disabled in production

## Notes

- **Startup validation** (implemented in P0 Feature Flag Enforcement) will fail fast if flags are missing
- **Error message** provides clear remediation steps
- **Development mode** does not require flags (validation skipped)
- **Build phase** does not require flags (validation skipped)

## Impact

Once flags are enabled:
- ✅ Password security: All passwords hashed with bcrypt
- ✅ Session security: All sessions use cryptographically signed JWT tokens
- ✅ XSS protection: All HTML content sanitized before rendering

## Rollback

If issues occur, flags can be disabled via Vercel environment variables:
- Set flag to `false` or remove variable
- Redeploy application
- System falls back to legacy behavior (not recommended for production)

