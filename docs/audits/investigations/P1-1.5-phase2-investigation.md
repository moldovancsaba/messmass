# P1 1.5 Phase 2 – Update CSS to Use Block Typography (Investigation)

**⚠️ SUPERSEDED:** This investigation document is superseded by `P1-1.5-phase2-implementation.md`. See canonical closure document `IMPLEMENTATION_COMPLETE.md` for authoritative evidence.

**Date:** 2026-01-10T14:10:05.420Z  
**Status:** SUPERSEDED  
**Investigator:** Tribeca  
**Reference:** `P1-1.5-unified-typography-solution.md` Phase 2

---

## Phase 2 Goal

Update CSS consumers to reference block-level typography variables (`--block-base-font-size` and `--block-subtitle-font-size`) instead of per-row or per-component font-size usage.

---

## Investigation Results

### 1. CellWrapper Title Zone

**File:** `components/CellWrapper.module.css:21`

**Current:**
```css
font-size: var(--title-font-size);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Title zone should use block-level typography, not per-row `--title-font-size`.

---

### 2. CellWrapper Subtitle Zone

**File:** `components/CellWrapper.module.css:49`

**Current:**
```css
font-size: var(--subtitle-font-size);
```

**Should be:**
```css
font-size: var(--block-subtitle-font-size);
```

**Alternative (if multiplier preferred):**
```css
font-size: calc(var(--block-base-font-size) * 0.875);
```

**Rationale:** Subtitle zone should use block-level typography. Solution document recommends using `--block-subtitle-font-size` directly (already calculated) or multiplier.

**Decision:** Use `var(--block-subtitle-font-size)` directly (already calculated at block level).

---

### 3. Chart Title (ReportChart.module.css)

**File:** `app/report/[slug]/ReportChart.module.css:51`

**Current:**
```css
font-size: clamp(0.9rem, 2.8cqw, 1.25rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Chart titles should use unified block typography, not independent responsive scaling.

---

### 4. KPI Label (Non-Value)

**File:** `app/report/[slug]/ReportChart.module.css:169`

**Current:**
```css
font-size: clamp(0.75rem, 15cqh, 1.5rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** KPI labels should participate in unified typography (per specification). Only KPI values are exempt.

---

### 5. Pie Chart Title Text

**File:** `app/report/[slug]/ReportChart.module.css:217`

**Current:**
```css
font-size: clamp(1rem, 9cqh, 1.5rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Pie chart titles should use unified block typography.

---

### 6. Pie Chart Title (Alternative)

**File:** `app/report/[slug]/ReportChart.module.css:238`

**Current:**
```css
font-size: clamp(0.9rem, 2.6cqw, 1.2rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Pie chart titles should use unified block typography.

---

### 7. Pie Chart Label

**File:** `app/report/[slug]/ReportChart.module.css:266`

**Current:**
```css
font-size: clamp(0.7rem, 2cqw, 0.9rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Pie chart labels should use unified block typography.

---

### 8. Pie Chart Legend Text

**File:** `app/report/[slug]/ReportChart.module.css:354-357`

**Current:**
```css
font-size: clamp(
  var(--mm-font-size-xxs, 0.625rem),
  min(20cqh, 12cqw),
  var(--mm-font-size-xl, 1.25rem)
);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Chart legends should use unified block typography.

---

### 9. Bar Chart Title

**File:** `app/report/[slug]/ReportChart.module.css:386`

**Current:**
```css
font-size: clamp(0.9rem, 2.6cqw, 1.2rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Bar chart titles should use unified block typography.

---

### 10. Bar Chart Label

**File:** `app/report/[slug]/ReportChart.module.css:424`

**Current:**
```css
font-size: clamp(0.85rem, 9cqh, 1.1rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Bar chart labels should use unified block typography.

---

### 11. Text Chart Title Text

**File:** `app/report/[slug]/ReportChart.module.css:513`

**Current:**
```css
font-size: clamp(0.95rem, 2.6cqw, 1.25rem) !important;
```

**Should be:**
```css
font-size: var(--block-base-font-size) !important;
```

**Rationale:** Text chart titles should use unified block typography.

---

### 12. Text Chart Content (Option B)

**File:** `app/report/[slug]/ReportChart.module.css:561`

**Current:**
```css
font-size: var(--unified-text-font-size, clamp(0.75rem, min(12cqh, 10cqw), 4rem)) !important;
```

**Should be:**
```css
font-size: var(--block-base-font-size) !important;
```

**Rationale:** Solution document recommends Option B - align text chart typography with block typography. Use `--block-base-font-size` instead of `--unified-text-font-size`.

---

### 13. Table Content

**File:** `app/report/[slug]/ReportChart.module.css:863`

**Current:**
```css
font-size: clamp(0.75rem, 1.5cqw, 0.875rem);
```

**Should be:**
```css
font-size: var(--block-base-font-size);
```

**Rationale:** Table headers and cells should use unified block typography.

---

## Exemptions (No Changes)

### KPI Value

**File:** `app/report/[slug]/ReportChart.module.css:143`

**Current:**
```css
font-size: clamp(1.25rem, min(30cqh, 25cqw), 6rem);
```

**Status:** ✅ **EXEMPT** - KPI values scale independently (explicit exemption per specification). No changes required.

---

## Summary

**Total CSS updates required:** 13

1. CellWrapper title zone (1)
2. CellWrapper subtitle zone (1)
3. Chart title (1)
4. KPI label (1)
5. Pie chart title text (1)
6. Pie chart title (1)
7. Pie chart label (1)
8. Pie chart legend text (1)
9. Bar chart title (1)
10. Bar chart label (1)
11. Text chart title text (1)
12. Text chart content (1)
13. Table content (1)

**Exemptions preserved:** KPI value (1)

---

## Implementation Plan

1. Update `components/CellWrapper.module.css`:
   - `.titleZone`: `var(--title-font-size)` → `var(--block-base-font-size)`
   - `.subtitleZone`: `var(--subtitle-font-size)` → `var(--block-subtitle-font-size)`

2. Update `app/report/[slug]/ReportChart.module.css`:
   - `.chartTitle`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.kpi .kpiTitle`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.pieTitleText`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.pieTitle`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.pieLabel`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.pieLegendText`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.barTitle`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.barLabel`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.textTitleText`: Remove `clamp()`, use `var(--block-base-font-size)`
   - `.textContent`: Replace `var(--unified-text-font-size, clamp(...))` with `var(--block-base-font-size)`
   - `.tableContent`: Remove `clamp()`, use `var(--block-base-font-size)`

3. **No changes to:**
   - KPI value scaling (exempt)
   - Typography scales, clamps, ratios (only replace with block variables)
   - Layout/structure
   - New CSS variables

---

## Next Steps

Proceed with implementation following the plan above.
