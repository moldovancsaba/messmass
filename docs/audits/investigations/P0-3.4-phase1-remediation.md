# P0 3.4 – Hardcoded Values & Inline Styles Remediation (Phase 1)

**Date:** 2026-01-10T11:29:22.300Z  
**Status:** ⏳ Preview Verification Pending  
**Priority:** P0 - CRITICAL  
**Owner:** Tribeca  
**Governing Rule:** P0 3.3 Design Tokens & Style Ownership Definition

---

## Executive Summary

Phase 1 remediation applies P0 3.3 rules to global CSS files (`app/globals.css` and `app/charts.css`) only. This phase focuses on replacing design language values (colors, spacing, typography, border radius) with design tokens while preserving contextual layout constraints.

---

## Scope

**Files Remediated:**
- `app/charts.css`
- `app/globals.css`

**Out of Scope:**
- Component CSS modules
- Admin pages
- Inline styles (handled in future phases)
- Contextual layout constraints (min-width, max-width, transforms)

---

## Remediation Applied

### Design Language Values → Tokens

#### **Hex Colors → Tokens:**
- `#1a202c` → `var(--mm-gray-900)`
- `#6b7280` → `var(--mm-gray-500)`
- `#374151` → `var(--mm-gray-700)`
- `#3b82f6` → `var(--mm-color-primary-500)`
- `#10b981` → `var(--mm-color-secondary-500)`
- `#f59e0b` → `var(--mm-warning)`
- `#8b5cf6` → `var(--mm-chart-purple)`
- `#06b6d4` → `var(--mm-chart-cyan)`
- `#f97316` → `var(--mm-chart-orange)`
- `#ef4444` → `var(--mm-error)`
- `#ccc` → `var(--mm-gray-300)`
- `#1e40af` → `var(--mm-color-primary-800)`
- `#047857` → `var(--mm-color-secondary-700)`

#### **Spacing → Tokens:**
- `0.75rem` → `var(--mm-radius-lg)` (border-radius) or `var(--mm-space-3)` (spacing)
- `2rem` → `var(--mm-space-8)`
- `0.5rem` → `var(--mm-space-2)`
- `0.25rem` → `var(--mm-space-1)`
- `8px` → `var(--mm-space-2)`
- `2px` → `var(--mm-space-1)`

#### **Typography → Tokens:**
- `20px` → `var(--mm-font-size-xl)`
- `12px` → `var(--mm-font-size-xs)`
- `0.875rem` → `var(--mm-font-size-sm)`

#### **Border Radius → Tokens:**
- `0.5rem` → `var(--mm-radius-md)`
- `12px` → `var(--mm-radius-lg)`
- `8px` → `var(--mm-radius-md)`

### Contextual Layout Constraints Preserved

**Per P0 3.3 Decision, the following remain hardcoded:**
- Structural constraints: `min-width: 400px`, `max-width: 550px`, `min-height`, `max-height`
- Micro-interaction transforms: `transform: translateY(-2px)`, `transform: translateX(2px)`
- Semantic borders: `border: 1px solid var(--mm-*)` (1px itself not tokenized)
- One-off layout math: `flex: 0 0 110px`, `height: 28px`, etc.

---

## Implementation Details

**Commits:**
- `f919fd859`: Replace hardcoded values with design tokens in app/charts.css and app/globals.css (Phase 1)
- `e21dc89c8`: Update progress for Phase 1 remediation
- `d7c7abd7d`: Acknowledge Chappie's decision on contextual layout constraints
- `4243c364d`: Update tracker status to ready for preview verification
- `7b69f4504`: Acknowledge readiness for preview verification
- `856428af3`: Acknowledge Chappie's confirmation and await push

**Local Gate:**
- ✅ Build pass (`npm run build`)

---

## Preview Verification

**Preview URL:** `https://messmass-git-preview-2026-01-02-agentic-coordination-narimato.vercel.app/`  
**Push Status:** ✅ Confirmed by Sultan (2026-01-10T11:22:22.000Z)  
**Verification Date:** 2026-01-10T11:31:02.300Z

**Verification Checklist:**
- [x] Push completed by Sultan
- [x] Preview URL accessible
- [ ] Charts render correctly with tokens (colors, spacing, typography)
- [ ] Global styles render correctly with tokens
- [ ] No visual regressions
- [ ] Chart colors match design system tokens
- [ ] Spacing and typography consistent with design system
- [ ] No broken styles or missing tokens
- [x] Preview URL captured in this report

**Pages Tested:**
- `/report/[slug]` pages with charts (pie charts, bar charts, KPI charts)
- Admin pages using global styles
- Chart components

**Expected vs Observed:**

1. **Chart Colors:**
   - **Expected:** Chart colors use design tokens (var(--mm-color-primary-500), var(--mm-color-secondary-500), var(--mm-warning), var(--mm-chart-purple), etc.)
   - **Observed:** ⏳ Awaiting visual verification

2. **Chart Spacing:**
   - **Expected:** Spacing uses design tokens (var(--mm-space-*), var(--mm-radius-*))
   - **Observed:** ⏳ Awaiting visual verification

3. **Chart Typography:**
   - **Expected:** Typography uses design tokens (var(--mm-font-size-*), var(--mm-gray-*))
   - **Observed:** ⏳ Awaiting visual verification

4. **Global Styles:**
   - **Expected:** Global styles render correctly with tokens, no broken styles
   - **Observed:** ⏳ Awaiting visual verification

5. **No Visual Regression:**
   - **Expected:** No broken styles, no missing tokens, no layout issues
   - **Observed:** ❌ **ISSUE FOUND:** In a block with 4 elements (2 unit text, 1 unit image, 1 unit image, 1 unit PIE Chart), the PIE Chart's lower legend text is overflowing and disappearing. This is a Layout Grammar violation (P0 1.3 No Clipping). The `.pieLegend` container with `overflow: hidden` is clipping legend text when the block height is constrained in multi-element layouts.

**Visual Verification Required:**
Since automated context cannot browse the preview, visual verification evidence is needed from Sultan/user:

1. Open Preview URL: `https://messmass-git-preview-2026-01-02-agentic-coordination-narimato.vercel.app/`
2. Navigate to `/report/[slug]` pages containing:
   - Pie charts with legends
   - Bar charts
   - KPI charts
3. Navigate to admin pages using global styles
4. Verify:
   - **Chart colors:** Match design system tokens (primary blue, secondary green, warning orange, etc.)
   - **Chart spacing:** Consistent with design system (padding, margins, gaps)
   - **Chart typography:** Uses design tokens (font sizes, colors)
   - **Global styles:** Render correctly, no broken styles
   - **No regression:** No visual regressions, no missing tokens, no layout issues

**Status:** ⏳ Awaiting visual verification evidence from Sultan/user

---

## Acceptance Criteria

- ✅ Design language values replaced with tokens
- ✅ Contextual constraints preserved
- ✅ No new tokens created (all used existing tokens)
- ✅ Local gate pass
- ⏳ Preview verification evidence
- ⏳ No visual regression confirmed

---

## Next Steps

After preview verification:
1. Update this document with verification evidence
2. Update Agentic Chat Log with PRESENT entry
3. Mark P0 3.4 Phase 1 checkbox [x] in audit plan
4. Declare P0 3.4 Phase 1 DONE + VERIFIED
5. Stop (no additional remediation in Phase 1)

---

## References

- **Governing Rule:** `docs/audits/investigations/P0-3.3-design-tokens-style-ownership.md`
- **Theme Tokens:** `app/styles/theme.css`
- **Audit Plan:** `docs/audits/COMPREHENSIVE_SYSTEM_AUDIT_PLAN_2026.md`
